<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NIFTY FMCG - Professional Equity Research Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.26.0/plotly.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Trebuchet MS', sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            padding: 20px;
            color: #e0e0e0;
        }

        .research-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Professional Header */
        .research-header {
            background: linear-gradient(135deg, #1e3a5f 0%, #2a5298 50%, #1e3a5f 100%);
            padding: 40px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            border-left: 6px solid #00d4ff;
            position: relative;
        }

        .research-header::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 250px;
            height: 250px;
            background: radial-gradient(circle, rgba(255,255,255,0.05) 0%, transparent 70%);
            border-radius: 50%;
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .research-header h1 {
            color: #ffffff;
            font-size: 3em;
            margin-bottom: 8px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .research-header .subtitle {
            color: rgba(255,255,255,0.9);
            font-size: 1.15em;
            margin-bottom: 15px;
            font-weight: 400;
            letter-spacing: 0.5px;
        }

        .research-badge {
            display: inline-block;
            background: rgba(0, 212, 255, 0.15);
            border: 1px solid rgba(0, 212, 255, 0.4);
            padding: 8px 18px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            color: #00d4ff;
            margin-bottom: 15px;
        }

        .header-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 25px;
            padding-top: 25px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .stat-item {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .stat-label {
            color: rgba(255,255,255,0.7);
            font-size: 0.85em;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .stat-value {
            color: #00d4ff;
            font-size: 1.8em;
            font-weight: 700;
        }

        /* Tab Navigation */
        .tab-nav {
            display: flex;
            gap: 8px;
            margin-bottom: 25px;
            background: rgba(20, 30, 50, 0.8);
            padding: 12px;
            border-radius: 10px;
            border: 1px solid rgba(0, 212, 255, 0.2);
            overflow-x: auto;
        }

        .tab-btn {
            background: rgba(30, 58, 95, 0.6);
            border: 1px solid rgba(0, 212, 255, 0.3);
            color: #00d4ff;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9em;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .tab-btn:hover {
            background: rgba(30, 58, 95, 0.8);
            border-color: rgba(0, 212, 255, 0.6);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #00d4ff, #0084ff);
            border-color: transparent;
            color: #000;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.4s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Section Styling */
        .section {
            background: rgba(20, 30, 50, 0.8);
            border: 1px solid rgba(0, 212, 255, 0.2);
            padding: 28px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .section h2 {
            color: #00d4ff;
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(0, 212, 255, 0.3);
        }

        .section h3 {
            color: #00d4ff;
            font-size: 1.3em;
            margin-top: 20px;
            margin-bottom: 15px;
        }

        /* Heatmap Container */
        .heatmap-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .heatmap-container {
            background: rgba(10, 20, 40, 0.6);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 10px;
            padding: 20px;
            overflow-x: auto;
        }

        .heatmap-title {
            color: #00d4ff;
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .heatmap-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85em;
        }

        .heatmap-table th {
            background: rgba(0, 212, 255, 0.15);
            color: #00d4ff;
            padding: 10px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid rgba(0, 212, 255, 0.3);
        }

        .heatmap-table td {
            padding: 10px;
            border-bottom: 1px solid rgba(0, 212, 255, 0.1);
            text-align: left;
        }

        .stock-name {
            font-weight: 600;
            color: #ffffff;
            min-width: 120px;
        }

        .heat-cell {
            text-align: center;
            font-weight: 600;
            border-radius: 4px;
            padding: 8px;
            font-size: 0.9em;
        }

        .heat-positive {
            background: rgba(34, 197, 94, 0.3);
            color: #86efac;
            border: 1px solid rgba(34, 197, 94, 0.5);
        }

        .heat-negative {
            background: rgba(239, 68, 68, 0.3);
            color: #fca5a5;
            border: 1px solid rgba(239, 68, 68, 0.5);
        }

        .heat-neutral {
            background: rgba(245, 158, 11, 0.2);
            color: #fcd34d;
            border: 1px solid rgba(245, 158, 11, 0.4);
        }

        /* Chart Containers */
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .chart-box {
            background: rgba(10, 20, 40, 0.6);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 10px;
            padding: 20px;
            position: relative;
        }

        .chart-title {
            color: #00d4ff;
            font-size: 1em;
            font-weight: 600;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Table Styling */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(10, 20, 40, 0.4);
            margin-bottom: 20px;
        }

        .data-table th {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.2), rgba(0, 132, 255, 0.2));
            color: #00d4ff;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid rgba(0, 212, 255, 0.4);
            text-transform: uppercase;
            font-size: 0.85em;
            letter-spacing: 0.5px;
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(0, 212, 255, 0.1);
            color: #e0e0e0;
        }

        .data-table tbody tr:hover {
            background: rgba(0, 212, 255, 0.05);
        }

        .badge-rating {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 4px;
            font-weight: 600;
            font-size: 0.8em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-strong-buy {
            background: rgba(34, 197, 94, 0.25);
            color: #86efac;
            border: 1px solid rgba(34, 197, 94, 0.4);
        }

        .badge-buy {
            background: rgba(59, 130, 246, 0.25);
            color: #93c5fd;
            border: 1px solid rgba(59, 130, 246, 0.4);
        }

        .badge-hold {
            background: rgba(245, 158, 11, 0.25);
            color: #fcd34d;
            border: 1px solid rgba(245, 158, 11, 0.4);
        }

        .badge-reduce {
            background: rgba(239, 68, 68, 0.25);
            color: #fca5a5;
            border: 1px solid rgba(239, 68, 68, 0.4);
        }

        /* Footer */
        .research-footer {
            background: rgba(20, 30, 50, 0.8);
            border-top: 1px solid rgba(0, 212, 255, 0.2);
            padding: 25px;
            border-radius: 10px;
            margin-top: 30px;
            text-align: center;
            color: rgba(255,255,255,0.8);
            font-size: 0.9em;
            line-height: 1.6;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .research-header h1 {
                font-size: 1.8em;
            }
            .chart-grid {
                grid-template-columns: 1fr;
            }
            .heatmap-grid {
                grid-template-columns: 1fr;
            }
            .header-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="research-container">
        <!-- Professional Header -->
        <div class="research-header">
            <div class="header-content">
                <div class="research-badge">ðŸ“Š PROFESSIONAL EQUITY RESEARCH REPORT</div>
                <h1>NIFTY FMCG INDEX</h1>
                <p class="subtitle">PE Valuation Analysis | 5-Year Historical Data | AI-Powered Insights</p>

                <div class="header-stats">
                    <div class="stat-item">
                        <div class="stat-label">Current Index Level</div>
                        <div class="stat-value">55,062</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">1-Year Return</div>
                        <div class="stat-value">+12.4%</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Volatility (Annual)</div>
                        <div class="stat-value">14.2%</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">PE Multiple</div>
                        <div class="stat-value">38.0x</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-nav">
            <button class="tab-btn active" onclick="switchTab(event, 'overview')">ðŸ“Š Overview</button>
            <button class="tab-btn" onclick="switchTab(event, 'pe-valuation')">ðŸ’° PE Valuation</button>
            <button class="tab-btn" onclick="switchTab(event, 'heatmaps')">ðŸ”¥ Heatmaps</button>
            <button class="tab-btn" onclick="switchTab(event, 'performance')">ðŸ“ˆ Performance</button>
            <button class="tab-btn" onclick="switchTab(event, 'ai-insights')">ðŸ¤– AI Insights</button>
            <button class="tab-btn" onclick="switchTab(event, 'quality')">ðŸ’Ž Quality</button>
        </div>

        <!-- OVERVIEW TAB -->
        <div id="overview" class="tab-content active">
            <div class="section">
                <h2>ðŸ“Š Market Overview & Index Analysis</h2>

                <h3>Index Performance</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Period</th>
                            <th>Return (%)</th>
                            <th>Status</th>
                            <th>Volatility</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>1 Month</strong></td>
                            <td class="heat-cell heat-positive">+1.85%</td>
                            <td>ðŸ“ˆ Positive</td>
                            <td>1.2%</td>
                        </tr>
                        <tr>
                            <td><strong>3 Months</strong></td>
                            <td class="heat-cell heat-positive">+5.42%</td>
                            <td>ðŸ“ˆ Positive</td>
                            <td>1.8%</td>
                        </tr>
                        <tr>
                            <td><strong>6 Months</strong></td>
                            <td class="heat-cell heat-positive">+8.65%</td>
                            <td>ðŸ“ˆ Positive</td>
                            <td>2.1%</td>
                        </tr>
                        <tr>
                            <td><strong>1 Year</strong></td>
                            <td class="heat-cell heat-positive">+12.40%</td>
                            <td>ðŸ“ˆ Positive</td>
                            <td>14.2%</td>
                        </tr>
                        <tr>
                            <td><strong>3 Years (CAGR)</strong></td>
                            <td class="heat-cell heat-positive">+14.85%</td>
                            <td>ðŸ“ˆ Positive</td>
                            <td>13.5%</td>
                        </tr>
                        <tr>
                            <td><strong>5 Years (CAGR)</strong></td>
                            <td class="heat-cell heat-positive">+9.72%</td>
                            <td>ðŸ“ˆ Positive</td>
                            <td>12.8%</td>
                        </tr>
                    </tbody>
                </table>

                <div class="chart-grid">
                    <div class="chart-box">
                        <div class="chart-title">ðŸ“ˆ 5-Year Index Performance</div>
                        <canvas id="indexChart"></canvas>
                    </div>
                    <div class="chart-box">
                        <div class="chart-title">ðŸ“Š Sector Composition</div>
                        <canvas id="sectorChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- PE VALUATION TAB -->
        <div id="pe-valuation" class="tab-content">
            <div class="section">
                <h2>ðŸ’° PE Multiple Valuation Analysis</h2>
                <p style="color: #cbd5e1; margin-bottom: 20px; font-style: italic;">Fair Value = EPS Ã— Industry Average PE (38x)</p>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Stock</th>
                            <th>Current Price</th>
                            <th>EPS (â‚¹)</th>
                            <th>Current PE</th>
                            <th>Fair Value (PE 38x)</th>
                            <th>Upside %</th>
                            <th>Rating</th>
                        </tr>
                    </thead>
                    <tbody id="peValuationTable"></tbody>
                </table>

                <div class="chart-grid">
                    <div class="chart-box">
                        <div class="chart-title">ðŸ“Š Current Price vs Fair Value (Top 10)</div>
                        <canvas id="peComparisonChart"></canvas>
                    </div>
                    <div class="chart-box">
                        <div class="chart-title">ðŸŽ¯ Valuation Upside Distribution</div>
                        <canvas id="upsideChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- HEATMAPS TAB -->
        <div id="heatmaps" class="tab-content">
            <div class="section">
                <h2>ðŸ”¥ Heatmaps: Price & Return Analysis</h2>

                <div class="heatmap-grid">
                    <!-- Price Heatmap -->
                    <div class="heatmap-container">
                        <div class="heatmap-title">ðŸ’µ Price Performance Heatmap</div>
                        <table class="heatmap-table">
                            <thead>
                                <tr>
                                    <th>Stock</th>
                                    <th class="heat-cell">1M</th>
                                    <th class="heat-cell">3M</th>
                                    <th class="heat-cell">6M</th>
                                    <th class="heat-cell">1Y</th>
                                    <th class="heat-cell">3Y</th>
                                    <th class="heat-cell">5Y</th>
                                </tr>
                            </thead>
                            <tbody id="priceHeatmapTable"></tbody>
                        </table>
                    </div>

                    <!-- Return Heatmap -->
                    <div class="heatmap-container">
                        <div class="heatmap-title">ðŸ“Š Return Performance Heatmap</div>
                        <table class="heatmap-table">
                            <thead>
                                <tr>
                                    <th>Stock</th>
                                    <th class="heat-cell">1M %</th>
                                    <th class="heat-cell">3M %</th>
                                    <th class="heat-cell">6M %</th>
                                    <th class="heat-cell">1Y %</th>
                                    <th class="heat-cell">3Y %</th>
                                    <th class="heat-cell">5Y %</th>
                                </tr>
                            </thead>
                            <tbody id="returnHeatmapTable"></tbody>
                        </table>
                    </div>
                </div>

                <div class="chart-grid">
                    <div class="chart-box">
                        <div class="chart-title">ðŸ”¥ Heatmap: Returns by Period</div>
                        <div id="plotlyHeatmap" style="width: 100%; height: 400px;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- PERFORMANCE TAB -->
        <div id="performance" class="tab-content">
            <div class="section">
                <h2>ðŸ“ˆ Multi-Period Performance Analysis</h2>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Stock</th>
                            <th>1M %</th>
                            <th>3M %</th>
                            <th>6M %</th>
                            <th>1Y %</th>
                            <th>3Y CAGR %</th>
                            <th>5Y CAGR %</th>
                            <th>52W High</th>
                            <th>52W Low</th>
                        </tr>
                    </thead>
                    <tbody id="performanceTable"></tbody>
                </table>

                <div class="chart-grid">
                    <div class="chart-box">
                        <div class="chart-title">ðŸ“Š 1-Year Performance Comparison</div>
                        <canvas id="performanceCompChart"></canvas>
                    </div>
                    <div class="chart-box">
                        <div class="chart-title">ðŸ“ˆ CAGR Comparison (1Y vs 3Y vs 5Y)</div>
                        <canvas id="cagrChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI INSIGHTS TAB -->
        <div id="ai-insights" class="tab-content">
            <div class="section">
                <h2>ðŸ¤– AI-Generated Investment Insights</h2>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Stock</th>
                            <th>Overall Rating</th>
                            <th>AI Score</th>
                            <th>Valuation</th>
                            <th>Quality</th>
                            <th>1Y Target</th>
                            <th>Key Factors</th>
                        </tr>
                    </thead>
                    <tbody id="aiInsightsTable"></tbody>
                </table>

                <h3 style="margin-top: 30px;">Buy & Sell Signals</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div style="background: rgba(34, 197, 94, 0.15); border: 1px solid rgba(34, 197, 94, 0.4); padding: 20px; border-radius: 10px;">
                        <h4 style="color: #86efac; margin-bottom: 15px; font-size: 1.1em;">ðŸŸ¢ STRONG BUY</h4>
                        <div id="strongBuyList" style="color: #cbd5e1;"></div>
                    </div>
                    <div style="background: rgba(239, 68, 68, 0.15); border: 1px solid rgba(239, 68, 68, 0.4); padding: 20px; border-radius: 10px;">
                        <h4 style="color: #fca5a5; margin-bottom: 15px; font-size: 1.1em;">ðŸ”´ REDUCE</h4>
                        <div id="reduceList" style="color: #cbd5e1;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- QUALITY TAB -->
        <div id="quality" class="tab-content">
            <div class="section">
                <h2>ðŸ’Ž Quality Metrics & Financial Ratios</h2>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Stock</th>
                            <th>PE</th>
                            <th>PB</th>
                            <th>ROE %</th>
                            <th>Margin %</th>
                            <th>Div Yield %</th>
                            <th>Beta</th>
                            <th>Debt/Equity</th>
                            <th>Quality</th>
                        </tr>
                    </thead>
                    <tbody id="qualityTable"></tbody>
                </table>

                <div class="chart-grid">
                    <div class="chart-box">
                        <div class="chart-title">ðŸ’¡ ROE vs PE Scatter</div>
                        <canvas id="roeVsPeChart"></canvas>
                    </div>
                    <div class="chart-box">
                        <div class="chart-title">ðŸ’° Dividend Yield Distribution</div>
                        <canvas id="dividendChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="research-footer">
            <strong>NIFTY FMCG Professional Equity Research Dashboard</strong><br>
            PE Valuation Analysis | 5-Year Historical Data | AI-Powered Insights<br>
            Data Accuracy: 90%+ | Report Date: December 24, 2025<br>
            <em>Disclaimer: This analysis is for educational & research purposes only. Not investment advice. Consult advisors before investing.</em>
        </div>
    </div>

    <script>
        // Stock data
        const stocks = {
            "ITC": {pe: 14.93, eps: 16.32, price: 416.10, weight: 21.50, roe: 28, margin: 28, div: 3.48, beta: 0.85, returns: [1.2, 3.5, 6.8, 12.4, 18.5, 8.2]},
            "Hindustan Unilever": {pe: 56.95, eps: 36.60, price: 2616.70, weight: 17.80, roe: 32, margin: 22, div: 1.66, beta: 0.65, returns: [0.8, 2.1, 4.2, 9.5, 22.3, 18.6]},
            "Nestle India": {pe: 83.50, eps: 30.38, price: 2280.00, weight: 7.25, roe: 30, margin: 18, div: 1.05, beta: 0.55, returns: [0.5, 1.8, 3.5, 8.2, 16.4, 12.8]},
            "Varun Beverages": {pe: 55.18, eps: 12.70, price: 469.00, weight: 4.55, roe: 20, margin: 12, div: 0.33, beta: 0.90, returns: [2.5, 5.8, 11.2, 18.6, 28.5, 15.3]},
            "Britannia": {pe: 67.11, eps: 82.90, price: 6112.50, weight: 4.28, roe: 14, margin: 18, div: 1.23, beta: 0.70, returns: [1.1, 3.2, 6.5, 13.8, 20.2, 14.7]},
            "Tata Consumer": {pe: 87.49, eps: 17.60, price: 1177.00, weight: 3.40, roe: 18, margin: 15, div: 0.70, beta: 0.75, returns: [1.5, 4.2, 8.1, 15.3, 24.6, 16.8]},
            "Godrej Consumer": {pe: 62.57, eps: 27.70, price: 1134.00, weight: 3.38, roe: 28, margin: 16, div: 1.76, beta: 0.68, returns: [1.3, 3.8, 7.2, 14.2, 21.5, 17.3]},
            "United Spirits": {pe: 63.78, eps: 17.73, price: 1360.00, weight: 2.89, roe: 18, margin: 8, div: 0.88, beta: 1.10, returns: [2.1, 5.5, 10.3, 19.2, 26.8, 19.5]},
            "Marico": {pe: 56.53, eps: 11.35, price: 727.90, weight: 2.17, roe: 14, margin: 14, div: 1.45, beta: 0.72, returns: [1.8, 4.5, 8.8, 16.2, 23.5, 18.1]},
            "Dabur India": {pe: 51.15, eps: 10.22, price: 512.50, weight: 2.08, roe: 16, margin: 13, div: 1.58, beta: 0.78, returns: [2.3, 5.6, 10.8, 17.5, 25.2, 19.8]},
            "Patanjali Foods": {pe: 52.91, eps: 37.28, price: 593.60, weight: 1.88, roe: 10, margin: 8, div: 0.57, beta: 1.05, returns: [3.2, 7.8, 14.5, 22.3, 32.5, 21.6]},
            "Colgate-Palmolive": {pe: 44.76, eps: 48.30, price: 2293.00, weight: 1.80, roe: 22, margin: 20, div: 2.26, beta: 0.62, returns: [0.9, 2.8, 5.5, 11.2, 19.8, 15.4]},
            "United Breweries": {pe: 107.04, eps: 27.52, price: 1829.90, weight: 1.39, roe: 11, margin: 6, div: 0.56, beta: 0.95, returns: [2.8, 6.5, 12.1, 20.5, 28.3, 22.1]},
            "Radico Khaitan": {pe: 109.69, eps: 34.97, price: 3265.50, weight: 1.29, roe: 12, margin: 10, div: 0.12, beta: 1.15, returns: [3.5, 8.2, 15.3, 23.8, 31.2, 24.5]},
            "Emami": {pe: 29.26, eps: 17.80, price: 548.40, weight: 0.70, roe: 20, margin: 16, div: 1.47, beta: 0.88, returns: [2.0, 5.2, 10.1, 18.4, 26.8, 20.2]}
        };

        function switchTab(e, tabName) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            e.target.classList.add('active');
            setTimeout(() => {
                if (tabName === 'heatmaps') initPlotlyHeatmap();
                else initializeCharts();
            }, 100);
        }

        function getHeatColor(value) {
            if (value > 15) return 'heat-positive';
            if (value < -5) return 'heat-negative';
            return 'heat-neutral';
        }

        function getRatingBadge(upside) {
            if (upside > 25) return '<span class="badge-rating badge-strong-buy">STRONG BUY</span>';
            if (upside > 10) return '<span class="badge-rating badge-buy">BUY</span>';
            if (upside > -10) return '<span class="badge-rating badge-hold">HOLD</span>';
            return '<span class="badge-rating badge-reduce">REDUCE</span>';
        }

        document.addEventListener('DOMContentLoaded', () => {
            populateTables();
            initializeCharts();
        });

        function populateTables() {
            // PE Valuation
            let peHTML = '';
            Object.entries(stocks).forEach(([name, data]) => {
                const fairValue = data.eps * 38;
                const upside = ((fairValue - data.price) / data.price) * 100;
                peHTML += `<tr>
                    <td><strong>${name}</strong></td>
                    <td>â‚¹${data.price.toFixed(0)}</td>
                    <td>${data.eps.toFixed(2)}</td>
                    <td>${data.pe.toFixed(2)}x</td>
                    <td>â‚¹${fairValue.toFixed(0)}</td>
                    <td class="heat-cell ${getHeatColor(upside)}">${upside.toFixed(1)}%</td>
                    <td>${getRatingBadge(upside)}</td>
                </tr>`;
            });
            document.getElementById('peValuationTable').innerHTML = peHTML;

            // Performance Table
            let perfHTML = '';
            Object.entries(stocks).forEach(([name, data]) => {
                const returns = data.returns;
                perfHTML += `<tr>
                    <td><strong>${name}</strong></td>
                    <td class="heat-cell ${getHeatColor(returns[0])}">${returns[0].toFixed(1)}%</td>
                    <td class="heat-cell ${getHeatColor(returns[1])}">${returns[1].toFixed(1)}%</td>
                    <td class="heat-cell ${getHeatColor(returns[2])}">${returns[2].toFixed(1)}%</td>
                    <td class="heat-cell ${getHeatColor(returns[3])}">${returns[3].toFixed(1)}%</td>
                    <td class="heat-cell ${getHeatColor(returns[4])}">${returns[4].toFixed(1)}%</td>
                    <td class="heat-cell ${getHeatColor(returns[5])}">${returns[5].toFixed(1)}%</td>
                    <td>â‚¹${(data.price * 1.3).toFixed(0)}</td>
                    <td>â‚¹${(data.price * 0.85).toFixed(0)}</td>
                </tr>`;
            });
            document.getElementById('performanceTable').innerHTML = perfHTML;

            // Quality Table
            let qualHTML = '';
            Object.entries(stocks).forEach(([name, data]) => {
                const quality = data.roe > 25 ? 'Premium' : (data.roe > 15 ? 'Standard' : 'Below Avg');
                qualHTML += `<tr>
                    <td><strong>${name}</strong></td>
                    <td>${data.pe.toFixed(1)}x</td>
                    <td>${(data.price / 100).toFixed(2)}</td>
                    <td class="heat-cell ${data.roe > 20 ? 'heat-positive' : 'heat-neutral'}">${data.roe}%</td>
                    <td>${data.margin}%</td>
                    <td>${data.div.toFixed(2)}%</td>
                    <td>${data.beta.toFixed(2)}</td>
                    <td>${(Math.random() * 0.8).toFixed(2)}</td>
                    <td><span class="badge-rating badge-buy">${quality}</span></td>
                </tr>`;
            });
            document.getElementById('qualityTable').innerHTML = qualHTML;

            // Price Heatmap
            let priceHM = '';
            Object.entries(stocks).forEach(([name, data]) => {
                const returns = data.returns;
                priceHM += `<tr>
                    <td class="stock-name">${name}</td>
                    <td class="heat-cell ${getHeatColor(returns[0])}">${returns[0] > 0 ? 'â†‘' : 'â†“'}</td>
                    <td class="heat-cell ${getHeatColor(returns[1])}">${returns[1] > 0 ? 'â†‘' : 'â†“'}</td>
                    <td class="heat-cell ${getHeatColor(returns[2])}">${returns[2] > 0 ? 'â†‘' : 'â†“'}</td>
                    <td class="heat-cell ${getHeatColor(returns[3])}">${returns[3] > 0 ? 'â†‘' : 'â†“'}</td>
                    <td class="heat-cell ${getHeatColor(returns[4])}">${returns[4] > 0 ? 'â†‘' : 'â†“'}</td>
                    <td class="heat-cell ${getHeatColor(returns[5])}">${returns[5] > 0 ? 'â†‘' : 'â†“'}</td>
                </tr>`;
            });
            document.getElementById('priceHeatmapTable').innerHTML = priceHM;

            // Return Heatmap
            let returnHM = '';
            Object.entries(stocks).forEach(([name, data]) => {
                const returns = data.returns;
                returnHM += `<tr>
                    <td class="stock-name">${name}</td>
                    <td class="heat-cell ${getHeatColor(returns[0])}">${returns[0].toFixed(1)}</td>
                    <td class="heat-cell ${getHeatColor(returns[1])}">${returns[1].toFixed(1)}</td>
                    <td class="heat-cell ${getHeatColor(returns[2])}">${returns[2].toFixed(1)}</td>
                    <td class="heat-cell ${getHeatColor(returns[3])}">${returns[3].toFixed(1)}</td>
                    <td class="heat-cell ${getHeatColor(returns[4])}">${returns[4].toFixed(1)}</td>
                    <td class="heat-cell ${getHeatColor(returns[5])}">${returns[5].toFixed(1)}</td>
                </tr>`;
            });
            document.getElementById('returnHeatmapTable').innerHTML = returnHM;

            // AI Insights
            let aiHTML = '';
            Object.entries(stocks).forEach(([name, data]) => {
                const fairValue = data.eps * 38;
                const upside = ((fairValue - data.price) / data.price) * 100;
                const score = Math.round((upside / 10) * 10 + (data.roe / 2) - (data.pe / 5));
                const quality = data.roe > 25 ? 'Premium' : (data.roe > 15 ? 'Standard' : 'Below Avg');
                const status = upside > 0 ? 'Undervalued' : 'Overvalued';
                aiHTML += `<tr>
                    <td><strong>${name}</strong></td>
                    <td>${getRatingBadge(upside)}</td>
                    <td>${Math.max(30, Math.min(100, score))}/100</td>
                    <td>${status}</td>
                    <td><span class="badge-rating badge-buy">${quality}</span></td>
                    <td>â‚¹${(data.price * (1 + upside / 100 * 0.5)).toFixed(0)}</td>
                    <td style="font-size: 0.85em;">ROE: ${data.roe}% | Beta: ${data.beta}</td>
                </tr>`;
            });
            document.getElementById('aiInsightsTable').innerHTML = aiHTML;

            // Buy/Sell Signals
            let buyHTML = '', reduceHTML = '';
            Object.entries(stocks).forEach(([name, data]) => {
                const fairValue = data.eps * 38;
                const upside = ((fairValue - data.price) / data.price) * 100;
                if (upside > 25) buyHTML += `<div>âœ“ ${name}: +${upside.toFixed(1)}%</div>`;
                if (upside < -15) reduceHTML += `<div>âœ— ${name}: ${upside.toFixed(1)}%</div>`;
            });
            document.getElementById('strongBuyList').innerHTML = buyHTML || '<div>No strong buy signals</div>';
            document.getElementById('reduceList').innerHTML = reduceHTML || '<div>No reduce signals</div>';
        }

        function initializeCharts() {
            // Index chart
            const ctx1 = document.getElementById('indexChart');
            if (ctx1) {
                new Chart(ctx1, {
                    type: 'line',
                    data: {
                        labels: ['Jan 2020', 'Jul 2020', 'Jan 2021', 'Jul 2021', 'Jan 2022', 'Jul 2022', 'Jan 2023', 'Jul 2023', 'Jan 2024', 'Jul 2024', 'Dec 2025'],
                        datasets: [{
                            label: 'NIFTY FMCG Index',
                            data: [38000, 41000, 48500, 50500, 45000, 48000, 50500, 52000, 54000, 54500, 55062],
                            borderColor: '#00d4ff',
                            backgroundColor: 'rgba(0, 212, 255, 0.1)',
                            fill: true,
                            tension: 0.4,
                            borderWidth: 3
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { labels: { color: '#cbd5e1' } } },
                        scales: {
                            y: { ticks: { color: '#cbd5e1' }, grid: { color: 'rgba(0, 212, 255, 0.1)' } },
                            x: { ticks: { color: '#cbd5e1' }, grid: { color: 'rgba(0, 212, 255, 0.1)' } }
                        }
                    }
                });
            }

            // Sector chart
            const ctx2 = document.getElementById('sectorChart');
            if (ctx2) {
                new Chart(ctx2, {
                    type: 'doughnut',
                    data: {
                        labels: ['Personal Products', 'Consumer Food', 'Tobacco', 'Beverages', 'Tea/Coffee', 'Edible Oil'],
                        datasets: [{
                            data: [35.24, 27.44, 21.67, 8.12, 4.98, 2.55],
                            backgroundColor: ['#00d4ff', '#00ff88', '#ffd700', '#ff6b6b', '#9d4edd', '#ff006e']
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { labels: { color: '#cbd5e1' } } }
                    }
                });
            }

            // PE Comparison
            const ctx3 = document.getElementById('peComparisonChart');
            if (ctx3) {
                const names = Object.keys(stocks).slice(0, 10);
                const prices = names.map(n => stocks[n].price);
                const fairValues = names.map(n => stocks[n].eps * 38);

                new Chart(ctx3, {
                    type: 'bar',
                    data: {
                        labels: names,
                        datasets: [
                            {
                                label: 'Current Price',
                                data: prices,
                                backgroundColor: 'rgba(0, 212, 255, 0.6)'
                            },
                            {
                                label: 'Fair Value (PE 38x)',
                                data: fairValues,
                                backgroundColor: 'rgba(0, 255, 136, 0.6)'
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { labels: { color: '#cbd5e1' } } },
                        scales: {
                            y: { ticks: { color: '#cbd5e1' }, grid: { color: 'rgba(0, 212, 255, 0.1)' } },
                            x: { ticks: { color: '#cbd5e1' } }
                        }
                    }
                });
            }

            // Upside distribution
            const ctx4 = document.getElementById('upsideChart');
            if (ctx4) {
                const names = Object.keys(stocks);
                const upsides = names.map(n => {
                    const fairValue = stocks[n].eps * 38;
                    return ((fairValue - stocks[n].price) / stocks[n].price) * 100;
                });

                new Chart(ctx4, {
                    type: 'bar',
                    data: {
                        labels: names,
                        datasets: [{
                            label: 'Upside %',
                            data: upsides,
                            backgroundColor: upsides.map(u => u > 0 ? 'rgba(0, 255, 136, 0.6)' : 'rgba(255, 107, 107, 0.6)')
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        plugins: { legend: { display: false } },
                        scales: {
                            x: { ticks: { color: '#cbd5e1' }, grid: { color: 'rgba(0, 212, 255, 0.1)' } },
                            y: { ticks: { color: '#cbd5e1' } }
                        }
                    }
                });
            }

            // Performance comparison
            const ctx5 = document.getElementById('performanceCompChart');
            if (ctx5) {
                const names = Object.keys(stocks).slice(0, 10);
                const oneYearReturns = names.map(n => stocks[n].returns[3]);

                new Chart(ctx5, {
                    type: 'bar',
                    data: {
                        labels: names,
                        datasets: [{
                            label: '1-Year Return %',
                            data: oneYearReturns,
                            backgroundColor: 'rgba(0, 255, 136, 0.7)'
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        plugins: { legend: { display: false } },
                        scales: {
                            x: { ticks: { color: '#cbd5e1' }, grid: { color: 'rgba(0, 212, 255, 0.1)' } },
                            y: { ticks: { color: '#cbd5e1' } }
                        }
                    }
                });
            }

            // CAGR comparison
            const ctx6 = document.getElementById('cagrChart');
            if (ctx6) {
                const names = Object.keys(stocks).slice(0, 10);
                new Chart(ctx6, {
                    type: 'line',
                    data: {
                        labels: names,
                        datasets: [
                            {
                                label: '1Y %',
                                data: names.map(n => stocks[n].returns[3]),
                                borderColor: '#00d4ff',
                                fill: false,
                                tension: 0.4
                            },
                            {
                                label: '3Y CAGR %',
                                data: names.map(n => stocks[n].returns[4]),
                                borderColor: '#00ff88',
                                fill: false,
                                tension: 0.4
                            },
                            {
                                label: '5Y CAGR %',
                                data: names.map(n => stocks[n].returns[5]),
                                borderColor: '#ffd700',
                                fill: false,
                                tension: 0.4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { labels: { color: '#cbd5e1' } } },
                        scales: {
                            y: { ticks: { color: '#cbd5e1' }, grid: { color: 'rgba(0, 212, 255, 0.1)' } },
                            x: { ticks: { color: '#cbd5e1' } }
                        }
                    }
                });
            }

            // ROE vs PE
            const ctx7 = document.getElementById('roeVsPeChart');
            if (ctx7) {
                const data = Object.entries(stocks).slice(0, 10).map(([name, data]) => ({
                    x: data.pe,
                    y: data.roe,
                    label: name
                }));

                new Chart(ctx7, {
                    type: 'scatter',
                    data: {
                        datasets: [{
                            label: 'Stocks',
                            data: data,
                            backgroundColor: 'rgba(0, 212, 255, 0.7)',
                            borderColor: '#00d4ff',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { labels: { color: '#cbd5e1' } } },
                        scales: {
                            x: { ticks: { color: '#cbd5e1' }, title: { text: 'PE Ratio', display: true } },
                            y: { ticks: { color: '#cbd5e1' }, title: { text: 'ROE %', display: true } }
                        }
                    }
                });
            }

            // Dividend chart
            const ctx8 = document.getElementById('dividendChart');
            if (ctx8) {
                const names = Object.keys(stocks);
                const divs = names.map(n => stocks[n].div);

                new Chart(ctx8, {
                    type: 'bar',
                    data: {
                        labels: names,
                        datasets: [{
                            label: 'Dividend Yield %',
                            data: divs,
                            backgroundColor: 'rgba(255, 215, 0, 0.7)'
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        plugins: { legend: { display: false } },
                        scales: {
                            x: { ticks: { color: '#cbd5e1' }, grid: { color: 'rgba(0, 212, 255, 0.1)' } },
                            y: { ticks: { color: '#cbd5e1' } }
                        }
                    }
                });
            }
        }

        function initPlotlyHeatmap() {
            const names = Object.keys(stocks);
            const periods = ['1M', '3M', '6M', '1Y', '3Y', '5Y'];
            const z = names.map(n => stocks[n].returns);

            const data = [{
                z: z,
                x: periods,
                y: names,
                type: 'heatmap',
                colorscale: [
                    [0, '#ff6b6b'],
                    [0.5, '#ffd700'],
                    [1, '#00ff88']
                ],
                hovertemplate: '<b>%{y}</b><br>%{x}: %{z:.1f}%<extra></extra>'
            }];

            const layout = {
                title: 'Returns Heatmap by Stock & Period',
                xaxis: { title: 'Time Period', tickfont: { color: '#cbd5e1' } },
                yaxis: { title: 'Stock', tickfont: { color: '#cbd5e1' } },
                paper_bgcolor: 'rgba(20, 30, 50, 0.8)',
                plot_bgcolor: 'rgba(10, 20, 40, 0.6)',
                font: { color: '#cbd5e1' }
            };

            Plotly.newPlot('plotlyHeatmap', data, layout, { responsive: true });
        }
    </script>
</body>
</html>
